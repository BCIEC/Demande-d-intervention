
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Demander une information ou une aide</title>

<style>
    :root{
        --blue:#0099ff;       /* bleu bande section */
        --brand:#0078d4;      /* bleu boutons */
        --bg:#f5f6fa;
        --text:#111;
        --muted:#666;
        --radius:12px;
    }

    /* ---------- Mise en page g√©n√©rale ---------- */
    body {
        font-family: Arial, Helvetica, sans-serif;
        margin: 0;
        background: var(--bg);
        color: var(--text);
    }

    .wrapper{
        max-width: 980px;
        margin: 0 auto 48px auto;
        padding: 0 18px 48px 18px;
    }

    /* ---------- En-t√™te style "Demander un devis" ---------- */
    .header {
        width: 100%;
        padding: 28px 0;
        background-color: #ffffff;
        text-align: center;
        border-bottom: 4px solid #e1e1e1;
        box-shadow: 0 2px 6px rgba(0,0,0,.04);
        position: sticky;
        top: 0;
        z-index: 5;
    }
    .header h1{
        margin: 0;
        font-size: 32px;
        font-weight: 800;
    }

    /* Bande bleue de section */
    .section-title {
        width: 100%;
        padding: 14px 20px;
        background-color: var(--blue);
        color: #fff;
        font-size: 22px;
        font-weight: bold;
        margin-top: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,.06) inset;
    }

    /* ---------- Carte formulaire ---------- */
    .card{
        background: #fff;
        padding: 22px;
        border-radius: var(--radius);
        box-shadow: 0 3px 10px rgba(0,0,0,.06);
        margin-top: 14px;
    }

    .form-group { margin-bottom: 16px; }
    label { font-weight: 700; display:block; }
    .help { color: var(--muted); font-size: 12px; margin-top: 6px; }

    input, select, textarea {
        width: 100%;
        padding: 10px 12px;
        margin-top: 6px;
        border: 1px solid #d9d9d9;
        border-radius: 8px;
        box-sizing: border-box;
        font-size: 15px;
        background: #fff;
    }
    textarea { min-height: 120px; resize: vertical; }

    .row { display: flex; gap: 20px; }
    .col { flex: 1; }

    /* ---------- Pied de formulaire (boutons) ---------- */
    .actions{
        display:flex; gap:12px; justify-content:flex-end; margin-top: 6px;
    }
    .btn{
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 700;
        font-size: 15px;
    }
    .btn-primary{ background: var(--brand); color:#fff; }
    .btn-primary:hover{ filter: brightness(0.92); }
    .btn-secondary{ background: #e9eef3; }
    .btn-secondary:hover{ filter: brightness(0.96); }

    /* ---------- Responsif ---------- */
    @media (max-width: 720px){
        .row{ flex-direction: column; }
        .header h1{ font-size: 24px; }
        .section-title{ font-size: 18px; }
    }
</style>
</head>

<body>

<!-- En‚Äët√™te style "Demander un devis" -->
<div class="header">
    <h1>Demander une information ou une aide</h1>
</div>

<div class="wrapper">
    <!-- Bande bleue de section -->
    <div class="section-title">Votre Demande</div>

    <!-- Carte formulaire -->
    <div class="card">
        <form id="formDemande" onsubmit="event.preventDefault(); submitForm();">

            <div class="row">
                <div class="col form-group">
                    <label for="categorie">Cat√©gorie *</label>
                    <select id="categorie" required onchange="updateSousCategorie()">
                        <option value="">- S√©lectionnez -</option>
                        <option value="supportOutil">Support Outil</option>
                        <option value="autreDemande">Autre Demande</option>
                    </select>
                    <div class="help">Le choix de la cat√©gorie adapte la liste de sous‚Äëcat√©gories.</div>
                </div>

                <div class="col form-group">
                    <label for="sscategorie">Sous-cat√©gorie *</label>
                    <select id="sscategorie" required>
                        <option value="">- Choisissez une cat√©gorie -</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="description">Description de la demande *</label>
                <textarea id="description" required placeholder="D√©crivez pr√©cis√©ment votre besoin..."></textarea>
            </div>

            <div class="section-title">Vos coordonn√©es</div>

            <div class="card" style="margin-top:0;">
                <div class="form-group">
                    <label for="email">Adresse e-mail *</label>
                    <input type="email" id="email" required placeholder="prenom.nom@domaine.fr">
                </div>

                <div class="form-group">
                    <label for="adresseInstallation">Adresse de l'installation *</label>
                    <input type="text" id="adresseInstallation" required placeholder="N¬∞, voie, compl√©ment, CP, ville">
                </div>

                <div class="row">
                    <div class="col form-group">
                        <label for="telephone">T√©l√©phone</label>
                        <input type="text" id="telephone" placeholder="ex: 01 23 45 67 89">
                    </div>
                    <div class="col form-group">
                        <label for="mobile">T√©l√©phone mobile</label>
                        <input type="text" id="mobile" placeholder="ex: 06 12 34 56 78">
                    </div>
                </div>

                <div class="actions">
                    <button type="reset" class="btn btn-secondary">Annuler</button>
                    <button type="submit" class="btn btn-primary">Envoyer</button>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
/* ============================================================================
 * 1) Sous-cat√©gories dynamiques selon la cat√©gorie
 * ==========================================================================*/
function updateSousCategorie() {
    const categorie = document.getElementById('categorie').value;
    const ssc = document.getElementById('sscategorie');

    ssc.innerHTML = ""; // reset

    let options = [];

    if (categorie === "supportOutil") {
        options = [
            "Compte utilisateur",
            "Droit d'acc√®s",
            "Installation",
            "Intervention",
            "Donn√©es erron√©es √† modifier"
        ];
    } else if (categorie === "autreDemande") {
        options = [
            "Facturation",
            "Devis",
            "Document",
            "Contrat",
            "Autre demande"
        ];
    } else {
        ssc.innerHTML = "<option value=''>- Choisissez une cat√©gorie -</option>";
        return;
    }

    options.forEach(o => {
        const option = document.createElement("option");
        option.value = o;
        option.textContent = o;
        ssc.appendChild(option);
    });
}

/* ============================================================================
 * 2) Envoi mailto + JSON encod√© dans l'URL Power Automate
 *    ‚ö†Ô∏è Remplacer la constante flowURL par l'URL de votre Flow.
 * ==========================================================================*/
function submitForm() {
    const data = {
        categorie: document.getElementById('categorie').value,
        sous_categorie: document.getElementById('sscategorie').value,
        description: document.getElementById('description').value,
        email: document.getElementById('email').value,
        adresseInstallation: document.getElementById('adresseInstallation').value,
        telephone: document.getElementById('telephone').value,
        mobile: document.getElementById('mobile').value,
        source: "form-demande-information",
        timestamp: new Date().toISOString()
    };

    // Validation minimale
    if (!data.categorie || !data.sous_categorie || !data.description || !data.email || !data.adresseInstallation) {
        alert("Merci de compl√©ter tous les champs obligatoires (*).");
        return;
    }

    // üîµ URL DU FLOW POWER AUTOMATE (d√©clencheur HTTP - GET)
    // Exemple : "https://prod-xx.westeurope.logic.azure.com:443/workflows/.../triggers/manual/paths/invoke"
    const flowURL = "https://prod-xx.westeurope.logic.azure.com/..."; // ‚Üê √† remplacer

    // JSON encod√© dans le param√®tre ?data=
    const finalURL = flowURL + "?data=" + encodeURIComponent(JSON.stringify(data));

    // Envoi vers Power Automate (non bloquant)
    fetch(finalURL).catch(err => console.error("Erreur Power Automate :", err));

    // Corps de mail lisible
    const mailBody = `
Cat√©gorie : ${data.categorie}
Sous-cat√©gorie : ${data.sous_categorie}

Description :
${data.description}

Adresse de l'installation :
${data.adresseInstallation}

Coordonn√©es :
Email : ${data.email}
T√©l√©phone : ${data.telephone}
Mobile : ${data.mobile}

(Envoy√© automatiquement depuis le portail)
    `;

    // Mailto : remplace l‚Äôadresse destinataire si n√©cessaire
    const destinataire = data.email;  // Ex: "support@votre-domaine.fr"
    const sujet = "Demande d'information / aide";
    window.location.href = `mailto:${encodeURIComponent(destinataire)}?subject=${encodeURIComponent(sujet)}&body=${encodeURIComponent(mailBody)}`;
}
</script>

</body>
</html>
``
